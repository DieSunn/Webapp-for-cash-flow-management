<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ó–∞–ø–∏—Å–∏ –î–î–°</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body class="container py-4">

    <h1 class="mb-4">–ó–∞–ø–∏—Å–∏ –¥–≤–∏–∂–µ–Ω–∏—è –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤</h1>

    <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
    <div class="mb-3">
        <a href="{% url 'cashflow_create' %}" class="btn btn-success">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å</a>
        <a href="{% url 'dictionaries_unified' %}" class="btn btn-outline-secondary">‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞–º–∏</a>
    </div>

    <!-- –§–∏–ª—å—Ç—Ä—ã -->
    <form method="get" class="row g-3 mb-4">
        <div class="col-md-2">
            <label class="form-label">–î–∞—Ç–∞ –æ—Ç</label>
            <input type="date" name="date_from" value="{{ request.GET.date_from }}" class="form-control">
        </div>
        <div class="col-md-2">
            <label class="form-label">–î–∞—Ç–∞ –¥–æ</label>
            <input type="date" name="date_to" value="{{ request.GET.date_to }}" class="form-control">
        </div>
        <div class="col-md-2">
            <label class="form-label">–°—Ç–∞—Ç—É—Å</label>
            <select name="status" class="form-select">
                <option value="">–í—Å–µ</option>
                {% for s in statuses %}
                    <option value="{{ s.id }}" {% if request.GET.status == s.id|stringformat:"s" %}selected{% endif %}>
                        {{ s.name }}
                    </option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-2">
            <label class="form-label">–¢–∏–ø</label>
            <select name="type" class="form-select">
                <option value="">–í—Å–µ</option>
                {% for t in types %}
                    <option value="{{ t.id }}" {% if request.GET.type == t.id|stringformat:"s" %}selected{% endif %}>
                        {{ t.name }}
                    </option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-2">
            <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
            <select name="category" class="form-select">
                <option value="">–í—Å–µ</option>
                {% for c in categories %}
                    <option value="{{ c.id }}" {% if request.GET.category == c.id|stringformat:"s" %}selected{% endif %}>
                        {{ c.name }}
                    </option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-2">
            <label class="form-label">–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è</label>
            <select name="subcategory" class="form-select">
                <option value="">–í—Å–µ</option>
                {% for sc in subcategories %}
                    <option value="{{ sc.id }}" {% if request.GET.subcategory == sc.id|stringformat:"s" %}selected{% endif %}>
                        {{ sc.name }}
                    </option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-12 d-flex justify-content-end mt-3">
            <button type="submit" class="btn btn-primary me-2">–§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å</button>
            <a href="{% url 'cashflow_list' %}" class="btn btn-secondary">–°–±—Ä–æ—Å–∏—Ç—å</a>
        </div>
    </form>
    <!-- –¢–∞–±–ª–∏—Ü–∞ –∑–∞–ø–∏—Å–µ–π -->
    <table class="table table-hover table-bordered">
        <thead class="table-light">
            <tr>
                <th>–î–∞—Ç–∞</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–¢–∏–ø</th>
                <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                <th>–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                <th>–°—É–º–º–∞</th>
                <th>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
        </thead>
        <tbody>
        {% for cashflow in cashflows %}
            <tr>
                <td>{{ cashflow.created_at }}</td>
                <td>{{ cashflow.status }}</td>
                <td>{{ cashflow.type }}</td>
                <td>{{ cashflow.category }}</td>
                <td>{{ cashflow.subcategory }}</td>
                <td><b>{{ cashflow.amount }}</b> ‚ÇΩ</td>
                <td>{{ cashflow.comment }}</td>
                <td>
                    <a href="{% url 'cashflow_edit' cashflow.pk %}" class="btn btn-sm btn-warning">‚úèÔ∏è</a>
                    <a href="{% url 'cashflow_delete' cashflow.pk %}" class="btn btn-sm btn-danger">üóë</a>
                </td>
            </tr>
        {% empty %}
            <tr><td colspan="8" class="text-center">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</td></tr>
        {% endfor %}
        </tbody>
    </table>

    <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
    {% if is_paginated %}
    <nav aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü">
    <ul class="pagination justify-content-center">

        <!-- –ù–∞–∑–∞–¥ -->
        {% if page_obj.has_previous %}
        <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.previous_page_number }}{{ request.GET.urlencode|cut:'page='|yesno:'&,' }}" aria-label="–ù–∞–∑–∞–¥">
            &laquo;
            </a>
        </li>
        {% else %}
        <li class="page-item disabled"><span class="page-link">&laquo;</span></li>
        {% endif %}

        <!-- –ù–æ–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü -->
        {% for num in paginator.page_range %}
        {% if page_obj.number == num %}
            <li class="page-item active"><span class="page-link">{{ num }}</span></li>
        {% else %}
            <li class="page-item">
            <a class="page-link" href="?page={{ num }}{{ request.GET.urlencode|cut:'page='|yesno:'&,' }}">{{ num }}</a>
            </li>
        {% endif %}
        {% endfor %}

        <!-- –í–ø–µ—Ä—ë–¥ -->
        {% if page_obj.has_next %}
        <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.next_page_number }}{{ request.GET.urlencode|cut:'page='|yesno:'&,' }}" aria-label="–í–ø–µ—Ä—ë–¥">
            &raquo;
            </a>
        </li>
        {% else %}
        <li class="page-item disabled"><span class="page-link">&raquo;</span></li>
        {% endif %}

    </ul>
    </nav>
    {% endif %}


</body>
</html>
